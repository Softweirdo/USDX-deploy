import{j as e,G as Y,b as U,r as g,d as _,e as O,f as B,g as M}from"./index-CATiC4f0.js";import{R as V,u as h,h as C,C as x,L as A,f as b,b as p}from"./moment-1QzQFXpc.js";function y({data:c=[],series:s=[],yAxisLabel:l,formatValue:m=d=>d.toString(),title:f}){if(!Array.isArray(c)||!Array.isArray(s)||c.length===0||s.length===0)return e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:"No data available"});try{const d=c.filter(a=>a.date?s.every(r=>{const i=a[r.key];return typeof i=="number"&&!isNaN(i)&&isFinite(i)}):!1);if(d.length===0)return e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:"Invalid data format"});const n={chart:{type:"bar",height:350,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}}},plotOptions:{bar:{borderRadius:4,horizontal:!1,columnWidth:"60%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{type:"category",categories:d.map(a=>a.date),labels:{style:{colors:"#64748b",fontSize:"12px"},hideOverlappingLabels:!0,rotate:0,rotateAlways:!0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{title:{text:l,style:{color:"#64748b"}},labels:{formatter:m,style:{colors:"#64748b",fontSize:"12px"}}},fill:{opacity:1,type:"solid"},tooltip:{enabled:!0,theme:"dark",y:{formatter:m}},legend:{position:"bottom",horizontalAlign:"center",offsetY:0,labels:{colors:"#64748b"}},grid:{borderColor:"#f1f5f9",strokeDashArray:4,padding:{top:0,right:20,bottom:20,left:20}}},o=s.map(a=>({name:a.label,data:d.map(r=>{const i=Number(r[a.key]);return isNaN(i)?0:i}),color:a.color}));return e.jsx("div",{className:"h-full w-full",children:e.jsx(V,{options:n,series:o,type:"bar",height:350})})}catch(d){return console.error("Chart error:",d),e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:"Error rendering chart"})}}function v({className:c=""}){return e.jsx("div",{className:`animate-pulse bg-gray-200 rounded ${c}`})}function R({showLegend:c=!0}){return e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[e.jsx(v,{className:"h-6 w-48 mb-6"}),c&&e.jsxs("div",{className:"flex justify-end mb-4 space-x-4",children:[e.jsx(v,{className:"h-4 w-20"}),e.jsx(v,{className:"h-4 w-20"})]}),e.jsx(v,{className:"h-[200px] w-full"})]})}function X(){var n,o;const{loading:c,error:s,data:l}=h(Y);if(c&&!l)return e.jsx(R,{});const m=((n=l==null?void 0:l.getFilteredTokenData)==null?void 0:n.map(a=>{const r={date:C(Number(a.timestamp)).format("MM/DD/YYYY")};return a.tokenBalance.forEach(i=>{r[i.tokenSymbol]=parseFloat(i.balance)}),r}))||[],d=Array.from(new Set((o=l==null?void 0:l.getFilteredTokenData)==null?void 0:o.flatMap(a=>a.tokenBalance.map(r=>r.tokenSymbol)))).map((a,r)=>({key:a,label:a,color:["#6366f1","#f59e0b","#10b981","#ec4899","#8b5cf6"][r%5]}));return e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"ALT Holding",children:e.jsx(A,{data:m,series:d,yAxisLabel:"Balance",formatValue:b})})})}const G=[];function H(){var n,o;const{loading:c,error:s,data:l}=h(U),m=((n=l==null?void 0:l.getFilteredTokenData)==null?void 0:n.map(a=>{const r={date:C(Number(a.timestamp)).format("MM/DD/YYYY")};return a.tokenBalance.forEach(i=>{r[i.tokenSymbol]=parseFloat(i==null?void 0:i.updatePr)}),r}))||[],d=Array.from(new Set((o=l==null?void 0:l.getFilteredTokenData)==null?void 0:o.flatMap(a=>a.tokenBalance.map(r=>r.tokenSymbol)))).map((a,r)=>({key:a,label:a,color:["#6366f1","#f59e0b","#10b981","#ec4899","#8b5cf6"][r%5]}));return e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"ALT Holding Profit",children:e.jsx(A,{data:m,series:d,yAxisLabel:"Percentage",formatValue:p})})})}const z=["#6366f1","#f59e0b","#10b981"];function $({filterChart:c,type:s}){var k,N,S,T,D,j,E,L,w;const{loading:l,error:m,data:f,refetch:d}=h(_,{variables:{type:"stack"}}),n=h(O),o=h(B);console.log("triggerDataGraph",o);const a=h(_,{variables:{type:"stack",tokenName:"USDX"}}),r=h(M);if(g.useEffect(()=>{const t=setTimeout(()=>{},1500);return()=>clearTimeout(t)},[]),g.useEffect(()=>{const t=setInterval(()=>{d()},45e3);return()=>clearInterval(t)},[d]),g.useEffect(()=>{const t=setInterval(()=>{n.refetch()},45e3);return()=>clearInterval(t)},[n.refetch]),g.useEffect(()=>{const t=setInterval(()=>{o.refetch()},45e3);return()=>clearInterval(t)},[o==null?void 0:o.refetch]),g.useEffect(()=>{const t=setInterval(()=>{a.refetch()},45e3);return()=>clearInterval(t)},[a==null?void 0:a.refetch]),g.useEffect(()=>{const t=setInterval(()=>{r.refetch()},45e3);return()=>clearInterval(t)},[r==null?void 0:r.refetch]),c&&G.filter(t=>t.title.toLowerCase().replace(/\s+/g,"-")===c),l&&((k=f==null?void 0:f.groupedStakingData)==null?void 0:k.length)===0)return e.jsx("div",{className:"grid grid-cols-1  gap-6",children:Array.from({length:c?2:4}).map((t,u)=>e.jsx(R,{},u))});const i=(N=n==null?void 0:n.data)!=null&&N.dateWiseAmountByToken?n.data.dateWiseAmountByToken.map(t=>{var I;let u={date:t==null?void 0:t.date};return(I=t==null?void 0:t.tokens)==null||I.map(P=>{u[`${P.tokenName}`]=P.totalAmount}),u}):[],F=((j=(D=(T=(S=n==null?void 0:n.data)==null?void 0:S.dateWiseAmountByToken)==null?void 0:T[0])==null?void 0:D.tokens)==null?void 0:j.map((t,u)=>({key:t==null?void 0:t.tokenName,color:z[u],label:t==null?void 0:t.tokenName})))||[];return console.log("usdx",o),e.jsxs("div",{className:"grid grid-cols-1  gap-6",children:[(s==="trigger"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"Trigger Peg",children:e.jsx(y,{data:((E=o==null?void 0:o.data)==null?void 0:E.getToken2BalanceByDate)||[],series:[{key:"percentage",color:"#10b981",label:"USDX"}],yAxisLabel:"Profit Percentage",formatValue:p})})}),(s==="alt"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(H,{})}),s==="usdx"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"USDX Stake",children:e.jsx(y,{data:((L=a==null?void 0:a.data)==null?void 0:L.groupedStakingData)||[],series:[{key:"totalAmount",color:"#6366f1",label:"USDX"}],yAxisLabel:"Amount in USDX",formatValue:b})})}),(s==="usdx"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"USDX Stake Profit",children:e.jsx(y,{data:((w=r==null?void 0:r.data)==null?void 0:w.getPercentageDifference)||[],series:[{key:"percentage",color:"#10b981",label:"Profit Percentage"}],yAxisLabel:"Percentage",formatValue:p})})}),s==="alt"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(X,{})}),(s==="daily"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"Daily Stake (USD)",children:e.jsx(y,{data:(f==null?void 0:f.groupedStakingData)||[],series:[{key:"totalAmount",color:"#6366f1",label:"USD"}],yAxisLabel:"Amount in USD",formatValue:b})})}),s==="daily"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(x,{title:"ALT Daily Stake",children:e.jsx(A,{data:i,series:F,yAxisLabel:"Amount in USD",formatValue:b})})})]})}export{$ as C};
