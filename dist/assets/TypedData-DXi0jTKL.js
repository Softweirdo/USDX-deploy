import{a as S,k as h,v as R,I as V,b as H}from"./Address-CIiG4KOT.js";import{bt as f,bm as l,bu as m,bv as w,bw as I,bx as d,by as D,bz as G,bA as E,bB as F,bC as J,bD as v}from"./index-Ch-ZZssA.js";import{a1 as P,a2 as A,a3 as q}from"./allowance-DCrhKD_o.js";function K({parameters:e,values:t}){const r=[];for(let n=0;n<e.length;n++)r.push(T({parameter:e[n],value:t[n]}));return r}function T({parameter:e,value:t}){const r=e,n=re(r.type);if(n){const[s,a]=n;return U(t,{length:s,parameter:{...r,type:a}})}if(r.type==="tuple")return te(t,{parameter:r});if(r.type==="address")return Q(t);if(r.type==="bool")return Y(t);if(r.type.startsWith("uint")||r.type.startsWith("int")){const s=r.type.startsWith("int"),[,,a="256"]=P.exec(r.type)??[];return Z(t,{signed:s,size:Number(a)})}if(r.type.startsWith("bytes"))return X(t,{type:r.type});if(r.type==="string")return ee(t);throw new j(r.type)}function $(e){let t=0;for(let a=0;a<e.length;a++){const{dynamic:i,encoded:o}=e[a];i?t+=32:t+=f(o)}const r=[],n=[];let s=0;for(let a=0;a<e.length;a++){const{dynamic:i,encoded:o}=e[a];i?(r.push(l(t+s,{size:32})),n.push(o),s+=f(o)):r.push(o)}return m(...r,...n)}function Q(e){return S(e,{strict:!1}),{dynamic:!1,encoded:w(e.toLowerCase())}}function U(e,{length:t,parameter:r}){const n=t===null;if(!Array.isArray(e))throw new se(e);if(!n&&e.length!==t)throw new ne({expectedLength:t,givenLength:e.length,type:`${r.type}[${t}]`});let s=!1;const a=[];for(let i=0;i<e.length;i++){const o=T({parameter:r,value:e[i]});o.dynamic&&(s=!0),a.push(o)}if(n||s){const i=$(a);if(n){const o=l(a.length,{size:32});return{dynamic:!0,encoded:a.length>0?m(o,i):o}}if(s)return{dynamic:!0,encoded:i}}return{dynamic:!1,encoded:m(...a.map(({encoded:i})=>i))}}function X(e,{type:t}){const[,r]=t.split("bytes"),n=f(e);if(!r){let s=e;return n%32!==0&&(s=I(s,Math.ceil((e.length-2)/2/32)*32)),{dynamic:!0,encoded:m(w(l(n,{size:32})),s)}}if(n!==Number.parseInt(r))throw new O({expectedSize:Number.parseInt(r),value:e});return{dynamic:!1,encoded:I(e)}}function Y(e){if(typeof e!="boolean")throw new d(`Invalid boolean value: "${e}" (type: ${typeof e}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:w(D(e))}}function Z(e,{signed:t,size:r}){if(typeof r=="number"){const n=2n**(BigInt(r)-(t?1n:0n))-1n,s=t?-n-1n:0n;if(e>n||e<s)throw new G({max:n.toString(),min:s.toString(),signed:t,size:r/8,value:e.toString()})}return{dynamic:!1,encoded:l(e,{size:32,signed:t})}}function ee(e){const t=E(e),r=Math.ceil(f(t)/32),n=[];for(let s=0;s<r;s++)n.push(I(F(t,s*32,(s+1)*32)));return{dynamic:!0,encoded:m(I(l(f(t),{size:32})),...n)}}function te(e,{parameter:t}){let r=!1;const n=[];for(let s=0;s<t.components.length;s++){const a=t.components[s],i=Array.isArray(e)?s:a.name,o=T({parameter:a,value:e[i]});n.push(o),o.dynamic&&(r=!0)}return{dynamic:r,encoded:r?$(n):m(...n.map(({encoded:s})=>s))}}function re(e){const t=e.match(/^(.*)\[(\d+)?\]$/);return t?[t[2]?Number(t[2]):null,t[1]]:void 0}function M(e,t){if(e.length!==t.length)throw new B({expectedLength:e.length,givenLength:t.length});const r=K({parameters:e,values:t}),n=$(r);return n.length===0?"0x":n}function L(e,t){if(e.length!==t.length)throw new B({expectedLength:e.length,givenLength:t.length});const r=[];for(let n=0;n<e.length;n++){const s=e[n],a=t[n];r.push(L.encode(s,a))}return m(...r)}(function(e){function t(r,n,s=!1){if(r==="address"){const p=n;return S(p),w(p.toLowerCase(),s?32:0)}if(r==="string")return E(n);if(r==="bytes")return n;if(r==="bool")return w(D(n),s?32:1);const a=r.match(P);if(a){const[p,y,u="256"]=a,c=Number.parseInt(u)/8;return l(n,{size:s?32:c,signed:y==="int"})}const i=r.match(A);if(i){const[p,y]=i;if(Number.parseInt(y)!==(n.length-2)/2)throw new O({expectedSize:Number.parseInt(y),value:n});return I(n,s?32:0)}const o=r.match(q);if(o&&Array.isArray(n)){const[p,y]=o,u=[];for(let c=0;c<n.length;c++)u.push(t(y,n[c],!0));return u.length===0?"0x":m(...u)}throw new j(r)}e.encode=t})(L);class ne extends d{constructor({expectedLength:t,givenLength:r,type:n}){super(`Array length mismatch for type \`${n}\`. Expected: \`${t}\`. Given: \`${r}\`.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.ArrayLengthMismatchError"})}}let O=class extends d{constructor({expectedSize:t,value:r}){super(`Size of bytes "${r}" (bytes${f(r)}) does not match expected size (bytes${t}).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.BytesSizeMismatchError"})}};class B extends d{constructor({expectedLength:t,givenLength:r}){super(["ABI encoding parameters/values length mismatch.",`Expected length (parameters): ${t}`,`Given length (values): ${r}`].join(`
`)),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.LengthMismatchError"})}}class se extends d{constructor(t){super(`Value \`${t}\` is not a valid array.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidArrayError"})}}class j extends d{constructor(t){super(`Type \`${t}\` is not a valid ABI Type.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiParameters.InvalidTypeError"})}}function ae(e){const{domain:t,message:r,primaryType:n,types:s}=e,a=(i,o)=>{for(const p of i){const{name:y,type:u}=p,c=o[y],b=u.match(P);if(b&&(typeof c=="number"||typeof c=="bigint")){const[,g,W]=b;l(c,{signed:g==="int",size:Number.parseInt(W??"")/8})}if(u==="address"&&typeof c=="string"&&!R(c))throw new V({address:c,cause:new H});const x=u.match(A);if(x){const[,g]=x;if(g&&f(c)!==Number.parseInt(g))throw new ce({expectedSize:Number.parseInt(g),givenSize:f(c)})}const z=s[u];z&&(fe(u),a(z,c))}};if(s.EIP712Domain&&t){if(typeof t!="object")throw new pe({domain:t});a(s.EIP712Domain,t)}if(n!=="EIP712Domain")if(s[n])a(s[n],r);else throw new ue({primaryType:n,types:s})}function ie(e){const{primaryType:t,types:r}=e;let n="";const s=k({primaryType:t,types:r});s.delete(t);const a=[t,...Array.from(s).sort()];for(const i of a)n+=`${i}(${(r[i]??[]).map(({name:o,type:p})=>`${p} ${o}`).join(",")})`;return n}function N(e){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},typeof(e==null?void 0:e.chainId)=="number"&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}function ge(e){const{domain:t,types:r}=e;return oe({data:t,primaryType:"EIP712Domain",types:{...r,EIP712Domain:(r==null?void 0:r.EIP712Domain)||N(t)}})}function oe(e){const{data:t,primaryType:r,types:n}=e,s=C({data:t,primaryType:r,types:n});return h(s)}function we(e){const{domain:t,message:r,primaryType:n,types:s}=e,a=(p,y)=>{const u={...y};for(const c of p){const{name:b,type:x}=c;x==="address"&&(u[b]=u[b].toLowerCase())}return u},i=(()=>{if(!t)return{};const p=s.EIP712Domain??N(t);return a(p,t)})(),o=(()=>{if(n!=="EIP712Domain")return s[n]?a(s[n],r):{}})();return v({domain:i,message:o,primaryType:n,types:s},(p,y)=>typeof y=="bigint"?y.toString():y)}function Ie(e){try{return ae(e),!0}catch{return!1}}class ce extends d{constructor({expectedSize:t,givenSize:r}){super(`Expected bytes${t}, got bytes${r}.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.BytesSizeMismatchError"})}}class pe extends d{constructor({domain:t}){super(`Invalid domain "${v(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidDomainError"})}}class ue extends d{constructor({primaryType:t,types:r}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(r))}\`.`,{metaMessages:["Check that the primary type is a key in `types`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidPrimaryTypeError"})}}class ye extends d{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"TypedData.InvalidStructTypeError"})}}function C(e){const{data:t,primaryType:r,types:n}=e,s=[{type:"bytes32"}],a=[de({primaryType:r,types:n})];for(const i of n[r]??[]){const[o,p]=_({types:n,name:i.name,type:i.type,value:t[i.name]});s.push(o),a.push(p)}return M(s,a)}function de(e){const{primaryType:t,types:r}=e,n=E(ie({primaryType:t,types:r}));return h(n)}function _(e){let{types:t,name:r,type:n,value:s}=e;if(t[n]!==void 0)return[{type:"bytes32"},h(C({data:s,primaryType:n,types:t}))];if(n==="bytes")return s=`0x${(s.length%2?"0":"")+s.slice(2)}`,[{type:"bytes32"},h(s,{as:"Hex"})];if(n==="string")return[{type:"bytes32"},h(J(s),{as:"Hex"})];if(n.lastIndexOf("]")===n.length-1){const a=n.slice(0,n.lastIndexOf("[")),i=s.map(o=>_({name:r,type:a,types:t,value:o}));return[{type:"bytes32"},h(M(i.map(([o])=>o),i.map(([,o])=>o)))]}return[{type:n},s]}function k(e,t=new Set){const{primaryType:r,types:n}=e,s=r.match(/^\w*/u),a=s==null?void 0:s[0];if(t.has(a)||n[a]===void 0)return t;t.add(a);for(const i of n[a])k({primaryType:i.type,types:n},t);return t}function fe(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new ye({type:e})}export{N as e,ge as h,we as s,Ie as v};
