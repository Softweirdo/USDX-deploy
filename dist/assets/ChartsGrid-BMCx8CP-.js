import{j as e,G as ce,b as te,r as x,d as ee,e as de,f as fe,g as me}from"./index-Ch-ZZssA.js";import{R as ue,u as h,h as re,C as g,L as T,f as A,b as S}from"./moment-Cy4TJLoQ.js";function k({data:c=[],series:s=[],yAxisLabel:r,formatValue:m=o=>o.toString(),title:N}){if(!Array.isArray(c)||!Array.isArray(s)||c.length===0||s.length===0)return e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:"No data available"});try{const o=c.filter(t=>t.date?s.every(n=>{const l=t[n.key];return typeof l=="number"&&!isNaN(l)&&isFinite(l)}):!1);if(o.length===0)return e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:"Invalid data format"});const f={chart:{type:"bar",height:350,toolbar:{show:!1},animations:{enabled:!0,easing:"easeinout",speed:800,animateGradually:{enabled:!0,delay:150},dynamicAnimation:{enabled:!0,speed:350}}},plotOptions:{bar:{borderRadius:4,horizontal:!1,columnWidth:"60%"}},dataLabels:{enabled:!1},stroke:{show:!0,width:2,colors:["transparent"]},xaxis:{type:"category",categories:o.map(t=>t.date),labels:{style:{colors:"#64748b",fontSize:"12px"},hideOverlappingLabels:!0,rotate:0,rotateAlways:!0},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{title:{text:r,style:{color:"#64748b"}},labels:{formatter:m,style:{colors:"#64748b",fontSize:"12px"}}},fill:{opacity:1,type:"solid"},tooltip:{enabled:!0,theme:"dark",y:{formatter:m}},legend:{position:"bottom",horizontalAlign:"center",offsetY:0,labels:{colors:"#64748b"}},grid:{borderColor:"#f1f5f9",strokeDashArray:4,padding:{top:0,right:20,bottom:20,left:20}}},i=s.map(t=>({name:t.label,data:o.map(n=>{const l=Number(n[t.key]);return isNaN(l)?0:l}),color:t.color}));return e.jsx("div",{className:"h-full w-full",children:e.jsx(ue,{options:f,series:i,type:"bar",height:350})})}catch(o){return console.error("Chart error:",o),e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-500",children:"Error rendering chart"})}}function p({className:c=""}){return e.jsx("div",{className:`animate-pulse bg-gray-200 rounded ${c}`})}function le({showLegend:c=!0}){return e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[e.jsx(p,{className:"h-6 w-48 mb-6"}),c&&e.jsxs("div",{className:"flex justify-end mb-4 space-x-4",children:[e.jsx(p,{className:"h-4 w-20"}),e.jsx(p,{className:"h-4 w-20"})]}),e.jsx(p,{className:"h-[200px] w-full"})]})}function he(){var f,i;const{loading:c,error:s,data:r}=h(ce);if(c&&!r)return e.jsx(le,{});const m=((f=r==null?void 0:r.getFilteredTokenData)==null?void 0:f.map(t=>{const n={date:re(Number(t.timestamp)).format("MM/DD/YYYY")};return t.tokenBalance.forEach(l=>{n[l.tokenSymbol]=parseFloat(l.balance)}),n}))||[],o=Array.from(new Set((i=r==null?void 0:r.getFilteredTokenData)==null?void 0:i.flatMap(t=>t.tokenBalance.map(n=>n.tokenSymbol)))).map((t,n)=>({key:t,label:t,color:["#6366f1","#f59e0b","#10b981","#ec4899","#8b5cf6"][n%5]}));return e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"ALT Holding",children:e.jsx(T,{data:m,series:o,yAxisLabel:"Balance",formatValue:A})})})}const ae=[];function ge(){var f,i;const{loading:c,error:s,data:r}=h(te);console.log("altper",r);const m=((f=r==null?void 0:r.getFilteredTokenData)==null?void 0:f.map(t=>{const n={date:re(Number(t.timestamp)).format("MM/DD/YYYY")};return t.tokenBalance.forEach(l=>{n[l.tokenSymbol]=parseFloat(l==null?void 0:l.updatePr)}),n}))||[],o=Array.from(new Set((i=r==null?void 0:r.getFilteredTokenData)==null?void 0:i.flatMap(t=>t.tokenBalance.map(n=>n.tokenSymbol)))).map((t,n)=>({key:t,label:t,color:["#6366f1","#f59e0b","#10b981","#ec4899","#8b5cf6"][n%5]}));return console.log("alt%",m,r),e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"ALT Holding Profit",children:e.jsx(T,{data:m,series:o,yAxisLabel:"Percentage",formatValue:S})})})}const xe=["#6366f1","#f59e0b","#10b981"];function ve({filterChart:c,type:s}){var j,E,P,L,w,I,_,G,B,F,U,C,R,Y,O;const r=h(te),{loading:m,error:N,data:o,refetch:f}=h(ee,{variables:{type:"stack"}}),i=h(de),t=h(fe),n=h(ee,{variables:{type:"stack",tokenName:"USDX"}}),l=h(me);if(x.useEffect(()=>{const a=setTimeout(()=>{},1500);return()=>clearTimeout(a)},[]),x.useEffect(()=>{const a=setInterval(()=>{f()},45e3);return()=>clearInterval(a)},[f]),x.useEffect(()=>{const a=setInterval(()=>{i.refetch()},45e3);return()=>clearInterval(a)},[i.refetch]),x.useEffect(()=>{const a=setInterval(()=>{t.refetch()},45e3);return()=>clearInterval(a)},[t==null?void 0:t.refetch]),x.useEffect(()=>{const a=setInterval(()=>{n.refetch()},45e3);return()=>clearInterval(a)},[n==null?void 0:n.refetch]),x.useEffect(()=>{const a=setInterval(()=>{l.refetch()},45e3);return()=>clearInterval(a)},[l==null?void 0:l.refetch]),x.useEffect(()=>{const a=setInterval(()=>{r.refetch()},45e3);return()=>clearInterval(a)},[r==null?void 0:r.refetch]),c&&ae.filter(a=>a.title.toLowerCase().replace(/\s+/g,"-")===c),m&&((j=o==null?void 0:o.groupedStakingData)==null?void 0:j.length)===0)return e.jsx("div",{className:"grid grid-cols-1 gap-6",children:Array.from({length:c?2:4}).map((a,d)=>e.jsx(le,{},d))});const ne=(E=i==null?void 0:i.data)!=null&&E.dateWiseAmountByToken?i.data.dateWiseAmountByToken.map(a=>{var b;let d={date:a==null?void 0:a.date};return(b=a==null?void 0:a.tokens)==null||b.map(y=>{d[`${y.tokenName}`]=y.totalAmount}),d}):[],se=((I=(w=(L=(P=i==null?void 0:i.data)==null?void 0:P.dateWiseAmountByToken)==null?void 0:L[0])==null?void 0:w.tokens)==null?void 0:I.map((a,d)=>({key:a==null?void 0:a.tokenName,color:xe[d],label:a==null?void 0:a.tokenName})))||[],D=[],v=new Set;(G=(_=t==null?void 0:t.data)==null?void 0:_.getToken2BalanceByDate)==null||G.forEach(a=>v.add(a.date)),(F=(B=l==null?void 0:l.data)==null?void 0:B.getPercentageDifference)==null||F.forEach(a=>v.add(a.date)),(C=(U=r==null?void 0:r.data)==null?void 0:U.getFilteredTokenData)==null||C.forEach(a=>{const d=new Date(Number(a.timestamp)).toLocaleDateString();v.add(d)}),Array.from(v).sort().forEach(a=>{var b,y,X,H,M,V,z,K,W,$,Q,q,J,Z;const d={date:a,"Trigger Peg":((X=(y=(b=t==null?void 0:t.data)==null?void 0:b.getToken2BalanceByDate)==null?void 0:y.find(u=>u.date===a))==null?void 0:X.percentage)||0,"USDX Stake":((V=(M=(H=l==null?void 0:l.data)==null?void 0:H.getPercentageDifference)==null?void 0:M.find(u=>u.date===a))==null?void 0:V.percentage)||0,"ALT Holding":(($=(W=(K=(z=r==null?void 0:r.data)==null?void 0:z.getFilteredTokenData)==null?void 0:K.find(u=>new Date(Number(u.timestamp)).toLocaleDateString()===a))==null?void 0:W.tokenBalance)==null?void 0:$.reduce((u,ie)=>u+(ie.updatePr||0),0))/(((Z=(J=(q=(Q=r==null?void 0:r.data)==null?void 0:Q.getFilteredTokenData)==null?void 0:q.find(u=>new Date(Number(u.timestamp)).toLocaleDateString()===a))==null?void 0:J.tokenBalance)==null?void 0:Z.length)||1)||0};D.push(d)});const oe=[{key:"Trigger Peg",color:"#10b981",label:"Trigger Peg"},{key:"USDX Stake",color:"#6366f1",label:"USDX Stake"},{key:"ALT Holding",color:"#f59e0b",label:"ALT Holding"}];return e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[s==="all"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"Profit Overview",children:e.jsx(T,{data:D,series:oe,yAxisLabel:"Profit Percentage",formatValue:S})})}),(s==="trigger"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"Trigger Peg",children:e.jsx(k,{data:((R=t==null?void 0:t.data)==null?void 0:R.getToken2BalanceByDate)||[],series:[{key:"percentage",color:"#10b981",label:"USDX"}],yAxisLabel:"Profit Percentage",formatValue:S})})}),(s==="alt"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(ge,{})}),s==="usdx"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"USDX Stake",children:e.jsx(k,{data:((Y=n==null?void 0:n.data)==null?void 0:Y.groupedStakingData)||[],series:[{key:"totalAmount",color:"#6366f1",label:"USDX"}],yAxisLabel:"Amount in USDX",formatValue:A})})}),(s==="usdx"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"USDX Stake Profit",children:e.jsx(k,{data:((O=l==null?void 0:l.data)==null?void 0:O.getPercentageDifference)||[],series:[{key:"percentage",color:"#10b981",label:"Profit Percentage"}],yAxisLabel:"Percentage",formatValue:S})})}),s==="alt"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(he,{})}),(s==="daily"||s==="all")&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"Daily Stake (USD)",children:e.jsx(k,{data:(o==null?void 0:o.groupedStakingData)||[],series:[{key:"totalAmount",color:"#6366f1",label:"USD"}],yAxisLabel:"Amount in USD",formatValue:A})})}),s==="daily"&&e.jsx("div",{className:"transform transition-all duration-500 hover:scale-[1.02]",children:e.jsx(g,{title:"ALT Daily Stake",children:e.jsx(T,{data:ne,series:se,yAxisLabel:"Amount in USD",formatValue:A})})})]})}export{ve as C};
